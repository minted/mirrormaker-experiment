[2020-02-04 17:08:44,417] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=49, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-49 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=38, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-38 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='testing0002', partitionIndex=0, controllerEpoch=4, leader=-1, leaderEpoch=1, isr=[3], zkVersion=1, replicas=[3], offlineReplicas=[3]) to brokers Set(4) for partition testing0002-0 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=27, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-27 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=16, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-16 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=19, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-19 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=8, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-8 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=2, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-2 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=13, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-13 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=24, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-24 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=35, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-35 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=46, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-46 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=5, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-5 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=43, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-43 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=21, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-21 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=32, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-32 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=10, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-10 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=37, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-37 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=48, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-48 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=29, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-29 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=18, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-18 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=40, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-40 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=7, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-7 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=34, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-34 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=45, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-45 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=23, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-23 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=26, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-26 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=4, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-4 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=15, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-15 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=42, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-42 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=20, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-20 (state.change.logger)
[2020-02-04 17:08:44,418] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=9, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-9 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=31, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-31 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=1, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-1 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=12, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-12 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=17, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-17 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=28, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-28 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=6, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-6 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=39, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-39 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=44, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-44 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=47, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-47 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=36, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-36 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=14, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-14 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=25, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-25 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=3, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-3 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='testing0003', partitionIndex=0, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition testing0003-0 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=41, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-41 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=30, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-30 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=11, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-11 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=33, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-33 (state.change.logger)
[2020-02-04 17:08:44,419] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=22, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-22 (state.change.logger)
[2020-02-04 17:08:44,420] TRACE [Controller id=2 epoch=4] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='__consumer_offsets', partitionIndex=0, controllerEpoch=3, leader=2, leaderEpoch=2, isr=[2], zkVersion=2, replicas=[2], offlineReplicas=[]) to brokers Set(4) for partition __consumer_offsets-0 (state.change.logger)
[2020-02-04 17:08:44,420] TRACE [Controller id=2 epoch=4] Received response {error_code=0,_tagged_fields={}} for request UPDATE_METADATA with correlation id 6 sent to broker localhost:9092 (id: 2 rack: null) (state.change.logger)
[2020-02-04 17:08:44,422] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition testing0002-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition testing0002-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:73)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:58)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:425)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1443)
	at kafka.controller.KafkaController.process(KafkaController.scala:1878)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-02-04 17:08:44,648] TRACE [Controller id=2 epoch=4] Received response {error_code=0,_tagged_fields={}} for request UPDATE_METADATA with correlation id 0 sent to broker localhost:9094 (id: 4 rack: null) (state.change.logger)
